<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Activity 1 - OB Training</title>
  <style>
    body {
      font-family: "Segoe UI", sans-serif;
      margin: 0;
      padding: 0;
      text-align: center;
      background-color: #f5f8fa;
      background-image: url("https://i.imgur.com/d2BCvGL.png");
      background-repeat: repeat;
      background-size: 180px;
      opacity: 0.95;
    }
    header {
      background-color: rgba(0, 43, 91, 0.9);
      color: white;
      padding: 15px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }
    header img { height: 45px; }
    h1 { font-size: 22px; margin: 0; }
    main {
      background-color: rgba(255, 255, 255, 0.95);
      border-radius: 10px;
      max-width: 800px;
      margin: 30px auto;
      padding: 30px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    input, button {
      padding: 10px;
      margin: 8px 0;
      border-radius: 6px;
      border: 1px solid #ccc;
      width: 100%;
      max-width: 300px;
    }
    button {
      background-color: #002b5b;
      color: white;
      cursor: pointer;
      border: none;
    }
    button:hover { background-color: #004a9f; }
    #result {
      font-weight: bold;
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <header>
    <img src="https://i.imgur.com/d2BCvGL.png" alt="Office Beacon Logo">
    <h1>Office Beacon Training - Activity 1</h1>
  </header>

  <main>
    <h2>Knowledge Quiz</h2>
    <form id="quizForm">
      <label for="name">Your Name:</label><br>
      <input type="text" id="name" name="name" required><br><br>

      <!-- Example question layout (replace with your working version’s questions) -->
      <div id="questions"></div>

      <button type="submit">Submit Activity 1</button>
    </form>

    <div id="result"></div>

    <button id="nextActivityBtn" style="display:none;">Proceed to Next Activity</button>
  </main>

  <script>
    // Example questions (use your own full list from your working Activity 1)
    const questions = [
      {q:"What does COI stand for?", a:"Certificate of Insurance"},
      {q:"Who issues an ACORD 25 form?", a:"Insurance Agent"},
    ];

    const qContainer = document.getElementById("questions");
    questions.forEach((q, i) => {
      const div = document.createElement("div");
      div.innerHTML = `
        <label>${i+1}. ${q.q}</label><br>
        <input type="text" id="q${i}" required><br><br>
      `;
      qContainer.appendChild(div);
    });

    document.getElementById("quizForm").addEventListener("submit", function(e){
      e.preventDefault();
      const name = document.getElementById("name").value.trim();
      if (!name) { alert("Please enter your name."); return; }

      let score = 0;
      questions.forEach((q, i) => {
        const ans = document.getElementById("q"+i).value.trim().toLowerCase();
        if (ans === q.a.toLowerCase()) score += 50; // adjust per question
      });

      document.getElementById("result").innerHTML =
        `✅ ${name}, your Activity 1 score is <b>${score}</b>.`;

      // Save to Activity Score sheet
      google.script.run.withSuccessHandler(() => {
        console.log("Score saved successfully.");
      }).saveActivity1(name, score);

      // Show proceed button
      document.getElementById("nextActivityBtn").style.display = "inline-block";

      // Save to localStorage for Activity 2
      localStorage.setItem("name", name);
      localStorage.setItem("scoreA1", score);
    });

    // === Redirect to Activity 2 ===
    function goToActivity2(name, scoreA1) {
      localStorage.setItem("name", name);
      localStorage.setItem("scoreA1", scoreA1);

      // Replace this after you deploy Activity 2
      const ACTIVITY_2_URL = "https://script.google.com/macros/s/AKfycbyYFIBz0gKGBAuX9wVDwbHljedTtyG1c-wtncQYJR9d9U7iASrRizR_ol6kpr6go_jA/exec";

      const target = `${ACTIVITY_2_URL}?name=${encodeURIComponent(name)}&scoreA1=${encodeURIComponent(scoreA1)}`;
      window.location.href = target;
    }

    document.getElementById("nextActivityBtn").addEventListener("click", function(){
      const name = localStorage.getItem("name");
      const score = localStorage.getItem("scoreA1");
      goToActivity2(name, score);
    });
  </script>
</body>
</html>
